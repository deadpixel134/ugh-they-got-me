#SingleInstance force; 스크린샷 관련#Include Gdip_all.ahk; https://github.com/cocobelgica/AutoHotkey-JSON; 자동 업데이트를 위한 스크립트; 전체 사이클에 27분 예상#Include JSON.ahk#Include Jxon.ahkSetWorkingDir %A_ScriptDir%GitVersion(User, Repo) {    url := "https://api.github.com/repos/" User "/" Repo "/releases/latest"    whr := ComObjCreate("WinHttp.WinHttpRequest.5.1")    whr.Open("GET", url, false), whr.Send()    RegExMatch(whr.ResponseText, "_name\W+\K[^""]+", tag)    return tag};	상남자특) 하드코딩함Version := % GitVersion("deadpixel134", "ugh-they-got-me"); !!!!!!!!!!!!!!!!제발 Version은 최신 릴리즈 태그 + 1이야. 업뎃할때 좀 잊어버리지 좀 마라!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!if Version >= 8{	UrlDownloadToFile, https://github.com/deadpixel134/ugh-they-got-me/releases/latest/download/package.zip, %A_WorkingDir%\package.zip	Msgbox,4, 업데이트가 존재합니다!, 업데이트가 존재하여 package.zip을 현재 폴더에 다운로드 했습니다. `n`n해당 파일을 현재 파일에 압축 풀기 및 덮어쓰기 후 재실행해주세요.`n`n깃허브 페이지를 열고 업데이트 노트를 확인하시겠어요?	ifMsgBox, Yes	Run https://github.com/deadpixel134/ugh-they-got-me/releases/latest/	ExitApp	ifMsgBox, No	ExitApp};게임과 상호작용하기 위한 관리자 권한 요청 스크립트full_command_line := DllCall("GetCommandLine", "str")if not (A_IsAdmin or RegExMatch(full_command_line, " /restart(?!\S)")){    try    {        if A_IsCompiled            Run *RunAs "%A_ScriptFullPath%" /restart        else            Run *RunAs "%A_AhkPath%" /restart "%A_ScriptFullPath%"    }    ExitApp};GUI 설정gui_title := "Map gacha"FileCreateDir, screenshotFormatTime date,, yyyy-MM-ddFormatTime time,, HH:mm:ssGui Show, w380 h220, %gui_title%Gui Color, White, WhiteGui Add, Text, w360 h15 +Center, %date% %time%에 실행됨Gui Add, Text, w360 h18 +Center vA, 준비Gui Add, Text, w360 h18 +Center vB, 0 회Gui Add, Text, x65 y100 w70 h18 +Center, 시작 번호Gui Add, Edit, x260 y100 w50 h18 vstart Number, 0Gui Add, Text, x0 y130 w200 h40 +Center, 끝 번호`n(에서 1을 뺀 숫자까지 돌아감)Gui Add, Edit, x260 y130 w50 h18 voffset Number, 50Gui Add, Button, x130 y160 w120 h30, 종료ReturnF1::{GuiControlGet,current,,start,GuiControlGet,tries,,offset,while current<tries{   	load=0	i=0	while load<1	{		PixelSearch, ,, 1620, 200, 1650, 240, 0xD5AB60, 10, Fast RGB	;픽셀 서치를 시작할 지점 X Y 좌표 - 끝 지점 X Y 좌표, RGB값, 오차값, Fast(빠른) RGB(형식)		 if((ErrorLevel = 0))			{			load=1			}		else		{   sleep,1500   i++   if(i>15)   {   msgbox,메인메뉴 발견 오류. F3을 눌러 매크로를 끄고 재시작해주세요.   }		}		}   GuiControl,,A,시작   Gui,Submit,nohide	;GUI의 값을 받아옵니다.   GuiControl,,A,시작		MouseClick, Left, 1657, 469,1   sleep,150		MouseClick, Left, 1637, 538,1   sleep,150   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50		Send {Backspace down}   sleep,50		Send {Backspace up}   sleep,50   	firstnumber:=current//1000	temp:=Mod(current,1000)	secondnumber:=temp//100	temp:=Mod(current,100)	thirdnumber:=temp//10	fourthnumber:=Mod(current,10)			Send {%firstnumber% down}   sleep,50		Send {%firstnumber% up}   sleep,50		Send {%secondnumber% down}   sleep,50		Send {%secondnumber% up}   sleep,50		Send {%thirdnumber% down}   sleep,50		Send {%thirdnumber% up}   sleep,50		Send {%fourthnumber% down}   sleep,50		Send {%fourthnumber% up}   sleep,50   		MouseClick, Left, 1125, 681,1   sleep,250		MouseClick, Left, 1125, 681,1   sleep,300		MouseClick, Left, 1269, 924,1   sleep,10000   SetNumLockState , Off   	load=0		GuiControl,,A,로딩 대기			while load<1	{	;게임 시작 후 우하단 솔져 초상화 찾기	PixelSearch, ,, 1856, 810, 1878, 830, 0xE46C49, 10, Fast RGB	;픽셀 서치를 시작할 지점 X Y 좌표 - 끝 지점 X Y 좌표, RGB값, 오차값, Fast(빠른) RGB(형식)		 if((ErrorLevel = 0))			{	;게임 시작 후 우하단 솔져 초상화 우측의 숫자 찾기	PixelSearch, ,, 1888, 810, 1902, 830, 0xE3D572, 10, Fast RGB	;픽셀 서치를 시작할 지점 X Y 좌표 - 끝 지점 X Y 좌표, RGB값, 오차값, Fast(빠른) RGB(형식)		 if((ErrorLevel = 0))			{				load++				Send {Pgdn Down} ;축소용 페이지 다운 누르기				sleep,200				send {F4} ;격자맵				sleep,100				Send {Space} ;일시정지				sleep,100				Send {NumLock Down} ;넘락 누르기				sleep,50				Send {numpad7 Down} ;넘패드 7번 누르기				sleep,50				Send {NumLock Up} ;넘락 떼기				sleep,450				Send {Pgdn Up} ;페이지 다운 떼기				GuiControl,,A,시작 완료			}			else			{			sleep, 500			}}	}   sleep,100   test:=current   Screenshot(test)   sleep,1500   GuiControl,,A,게임 나가기   send {Esc}   sleep,200		MouseClick, Left, 1598, 610,1      current:=current+1   test=%current%      GuiControl, , B, %test% 회   GuiControl,,A,게임 나가기 완료      sleep,10000}}return   F2::   {      Reload   }returnF3::   {         매크로시작 := false      ExitApp   }return!F1::   {   				sleep,150				Send {NumLock Down} ;넘락 누르기				sleep,150				Send {numpad7 Down} ;넘패드 7번 누르기				sleep,150				Send {NumLock Up} ;넘락 떼기   }return   Button종료:{    매크로시작 := false    ExitApp}returnScreenshot(OutFile){   pToken := Gdip_Startup()   screen=0|0|%A_ScreenWidth%|%A_ScreenHeight%   pBitmap := Gdip_BitmapFromScreen(screen)      	firstnumber:=OutFile//1000	temp:=Mod(OutFile,1000)	secondnumber:=temp//100	temp:=Mod(OutFile,100)	thirdnumber:=temp//10	fourthnumber:=Mod(OutFile,10)	   location = %A_ScriptDir%\screenshot\%firstnumber%%secondnumber%%thirdnumber%%fourthnumber%.png   Gdip_SaveBitmapToFile(pBitmap, location, 100)   Gdip_DisposeImage(pBitmap)   Gdip_Shutdown(pToken)};F4::;{;current:=1	;firstnumber:=current//1000	;temp:=Mod(current,1000)	;secondnumber:=temp//100	;temp:=Mod(current,100)	;thirdnumber:=temp//10	;fourthnumber:=Mod(current,10)	;msgbox, %firstnumber%	;msgbox, %secondnumber%	;msgbox, %thirdnumber%	;msgbox, %fourthnumber%;}